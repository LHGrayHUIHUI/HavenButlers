# 文件存储服务测试页面

## 概述

这是一个用于测试 HavenButler 文件存储服务功能的简单Web页面，提供了直观的界面来测试文件上传、下载、列表查看和存储统计等功能。

## 功能特性

### 📤 文件上传
- **多文件支持**: 可同时选择和上传多个文件
- **拖拽上传**: 支持将文件拖拽到上传区域
- **进度显示**: 实时显示上传进度条
- **分类管理**: 支持按文档、图片、视频、音频等分类存储
- **家庭隔离**: 支持按家庭ID进行数据隔离

### 📋 文件管理
- **文件列表**: 查看指定家庭的所有文件
- **文件详情**: 显示文件名、大小、类型、上传时间等信息
- **文件下载**: 一键下载已上传的文件
- **文件删除**: 安全删除不需要的文件

### 📊 存储统计
- **总体统计**: 显示文件总数和存储空间使用情况
- **分类统计**: 按文件类型统计数量和空间占用
- **实时更新**: 动态获取最新的存储信息

## 使用方法

### 1. 启动服务
确保文件存储服务已启动：
```bash
cd /Users/yjlh/Documents/code/HavenButler/services/storage-service
mvn spring-boot:run -Dspring-boot.run.profiles=local
```

### 2. 打开测试页面
在浏览器中打开测试页面：
```
file:///Users/yjlh/Documents/code/HavenButler/services/storage-service/src/test/file-test.html
```

### 3. 测试功能

#### 文件上传测试
1. 输入测试用的家庭ID（默认: test-family-001）
2. 输入测试用的用户ID（默认: test-user-001）
3. 选择文件分类
4. 点击选择文件或拖拽文件到上传区域
5. 点击"上传文件"按钮

#### 文件管理测试
1. 在"文件列表"区域输入要查询的家庭ID
2. 点击"刷新文件列表"按钮
3. 查看文件列表，可以下载或删除文件

#### 存储统计测试
1. 输入家庭ID
2. 点击"获取统计信息"按钮
3. 查看存储使用情况统计

## API接口说明

测试页面调用的主要API接口：

### 文件上传
- **接口**: `POST /api/v1/files/upload`
- **参数**:
  - `file`: 上传的文件
  - `familyId`: 家庭ID
  - `userId`: 用户ID
  - `category`: 文件分类

### 文件列表
- **接口**: `GET /api/v1/files/list?familyId={familyId}`
- **参数**: familyId（查询参数）

### 文件下载
- **接口**: `GET /api/v1/files/download/{fileId}`
- **参数**: fileId（路径参数）

### 文件删除
- **接口**: `DELETE /api/v1/files/delete/{fileId}`
- **参数**: fileId（路径参数）

### 存储统计
- **接口**: `GET /api/v1/files/stats/{familyId}`
- **参数**: familyId（路径参数）

## 技术特性

### 前端技术
- **HTML5**: 语义化标签，支持文件拖拽
- **CSS3**: 现代化样式，响应式设计
- **JavaScript ES6+**: 异步处理，Promise/async-await
- **Fetch API**: 现代化的HTTP请求

### 用户体验
- **响应式设计**: 适配不同屏幕尺寸
- **实时反馈**: 上传进度、操作结果即时显示
- **友好交互**: 悬停效果、过渡动画
- **错误处理**: 完善的错误提示和异常处理

### 安全考虑
- **参数验证**: 前端基础参数校验
- **错误提示**: 用户友好的错误信息
- **文件类型**: 支持多种文件格式测试

## 注意事项

1. **服务地址**: 确保文件存储服务在 `http://localhost:8081` 运行
2. **跨域问题**: 如遇到跨域问题，需要服务端配置CORS
3. **文件大小**: 测试时建议使用小文件（<10MB）
4. **浏览器兼容**: 推荐使用现代浏览器（Chrome、Firefox、Safari、Edge）

## 故障排查

### 常见问题

1. **上传失败**
   - 检查服务是否正常启动
   - 确认服务地址是否正确
   - 查看浏览器控制台错误信息

2. **文件列表为空**
   - 确认输入了正确的家庭ID
   - 检查该家庭是否已上传文件
   - 查看网络请求是否成功

3. **下载失败**
   - 确认文件ID是否正确
   - 检查文件是否存在于服务器
   - 查看浏览器下载设置

### 调试方法
1. 打开浏览器开发者工具（F12）
2. 查看Console标签的错误信息
3. 查看Network标签的HTTP请求状态
4. 检查服务端日志输出

## 扩展功能

可以根据需要添加以下功能：
- 文件预览功能
- 批量操作（批量删除、批量下载）
- 文件搜索和过滤
- 上传速度限制
- 文件重命名功能
- 分享链接生成