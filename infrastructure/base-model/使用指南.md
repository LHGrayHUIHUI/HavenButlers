# HavenButler base-model 使用指南

## 📦 已发布到 GitHub Packages

base-model 已成功发布到 GitHub Packages：
- **仓库地址**: https://maven.pkg.github.com/LHGrayHUIHUI/HavenButlers
- **GroupId**: `com.haven`
- **ArtifactId**: `base-model`
- **Version**: `1.0.0`

## 🔧 在其他项目中使用

### 1. 添加 GitHub Packages 仓库

在其他微服务项目的 `pom.xml` 中添加：

```xml
<repositories>
    <repository>
        <id>github</id>
        <url>https://maven.pkg.github.com/LHGrayHUIHUI/HavenButlers</url>
    </repository>
</repositories>
```

### 2. 添加依赖

```xml
<dependencies>
    <dependency>
        <groupId>com.haven</groupId>
        <artifactId>base-model</artifactId>
        <version>1.0.0</version>
    </dependency>
</dependencies>
```

### 3. 配置认证

在 `~/.m2/settings.xml` 中添加 GitHub 认证信息：

```xml
<settings>
    <servers>
        <server>
            <id>github</id>
            <username>LHGrayHUIHUI</username>
            <password>YOUR_GITHUB_TOKEN</password>
        </server>
    </servers>
</settings>
```

## 📚 可使用的功能

base-model 提供以下核心功能：

### 1. 统一响应格式
```java
import com.haven.base.common.response.ResponseWrapper;
import com.haven.base.common.response.ErrorCode;

// 成功响应
ResponseWrapper<User> success = ResponseWrapper.success(userData);

// 错误响应
ResponseWrapper<Void> error = ResponseWrapper.error(ErrorCode.PARAM_ERROR);
```

### 2. 错误码定义
```java
import com.haven.base.common.response.ErrorCode;

// 系统级错误 10000-19999
ErrorCode.SYSTEM_ERROR          // 10000, "系统内部错误"
ErrorCode.SERVICE_UNAVAILABLE   // 10001, "服务不可用"

// 认证授权错误 20000-29999
ErrorCode.UNAUTHORIZED          // 20000, "未登录或登录已过期"
ErrorCode.FORBIDDEN             // 20001, "没有权限访问"

// 参数校验错误 30000-39999
ErrorCode.PARAM_ERROR           // 30000, "参数错误"
ErrorCode.PARAM_MISSING         // 30001, "缺少必要参数"
```

### 3. 通用异常类
```java
import com.haven.base.common.exception.*;

// 业务异常
throw new BusinessException(ErrorCode.DATA_NOT_FOUND);

// 系统异常
throw new SystemException(ErrorCode.SYSTEM_ERROR);

// 认证异常
throw new AuthException(ErrorCode.UNAUTHORIZED);
```

### 4. 工具类
```java
import com.haven.base.utils.*;

// TraceID 生成
String traceId = TraceIdUtil.generate(); // tr-20250917-100000-a3b5c7

// JSON 处理
String json = JsonUtil.toJson(object);
User user = JsonUtil.fromJson(json, User.class);

// 加密工具
String encrypted = EncryptUtil.encryptAES(data, key);
String decrypted = EncryptUtil.decryptAES(encrypted, key);
```

### 5. 分页支持
```java
import com.haven.base.model.dto.*;

// 分页请求
PageRequest pageRequest = new PageRequest();
pageRequest.setPage(1);
pageRequest.setSize(10);

// 分页响应
PageResponse<User> pageResponse = PageResponse.of(userList, pageRequest, total);
```

### 6. 基础实体类
```java
import com.haven.base.model.entity.BaseEntity;

@Entity
public class User extends BaseEntity {
    // 自动包含 id, createTime, updateTime, version 等字段
}
```

## 🔄 下一步：发布 common 模块

如果需要发布 common 模块，可以使用相同的配置流程。

## 🐛 故障排查

### 1. 无法下载依赖
- 检查 GitHub token 是否有效且有 `read:packages` 权限
- 确认 settings.xml 配置正确

### 2. 编译错误
- 确保使用 JDK 17
- 检查依赖版本兼容性

### 3. 包未找到
- 确认仓库 URL 正确
- 检查网络连接